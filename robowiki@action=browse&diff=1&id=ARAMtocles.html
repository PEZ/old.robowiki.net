<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML><HEAD><TITLE>ARAMtocles - Robo Wiki -= Collecting Robocode Knowledge =-</TITLE>
<META NAME='KEYWORDS' CONTENT='ARAMtocles'/>
<LINK REL="stylesheet" HREF="/robodocs/wiki.css">
</HEAD><BODY BGCOLOR="white">
<div class=wikiheader><h1><a href="robowiki@Robo_Home"><img src="/images/RoboWiki.png" alt="[Home]" border=0 align="right"></a><a href="robowiki@back=ARAMtocles">ARAMtocles</a></h1><a href="robowiki@Robo_Home" class=wikipagelink>Robo Home</a> | <a href="robowiki@Changes" class=wikipagelink>Changes</a> | <a href="robowiki@action=editprefs">Preferences</a> | <a href='?action=index'>AllPages</a><br>
<hr class=wikilineheader></div><b>Difference (from prior major revision)</b>
(<a href="robowiki@action=browse&diff=2&id=ARAMtocles">minor diff</a>, <a href="robowiki@action=browse&diff=3&id=ARAMtocles">author diff</a>)<br> <br><strong>Added: 11a12,17</strong><br><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
<H3>History</H3><br><br> <br> * 0.3: rating 1598 (<a href="robowiki@NanoDeath" class=wikipagelink>NanoDeath</a> - 22)<br> * 0.2: rating 1599 (<a href="robowiki@NanoDeath" class=wikipagelink>NanoDeath</a> - 21)<br> * 0.1: rating 1608 (<a href="robowiki@NanoDeath" class=wikipagelink>NanoDeath</a> - 12)<br> <br></td></tr></table>
 <br><strong>Changed: 32c38,39</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
  *<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
  * v0.3 20060217 Removed reverse wall stuff.<br>  *               Rearranged distance segmentation and bulletpower. 707 bytes<br></td></tr></table>
 <br><strong>Changed: 36,41c43,46</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
     static Rectangle2D.Double fireField;	// the shootable battlefield<br> <br> <br>     static final double MAX_DISTANCE = 300;<br>     static final double MAX_BULLET_POWER = 3.0;<br>     static final double BULLET_POWER = 1.9;<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
     static final double MAX_DISTANCE = 450;<br>     static final double BULLET_SWITCH_DISTANCE = 180;<br>     static final double MAX_BULLET_POWER = 3.0;       // first two distance segments<br>     static final double BULLET_POWER = 1.9;           // third and fourth distance segment<br></td></tr></table>
 <br><strong>Changed: 44c49</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
     static final int DISTANCE_INDEXES = 3;<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
     static final int DISTANCE_INDEXES = 5;<br></td></tr></table>
 <br><strong>Changed: 47c52</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
     static final int WALL_INDEXES = 3;<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
     static final int WALL_INDEXES = 2;<br></td></tr></table>
 <br><strong>Changed: 49c54</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
     static final int AIM_FACTORS = 33;<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
     static final int AIM_FACTORS = 25;<br></td></tr></table>
 <br><strong>Added: 51a57</strong><br><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
     static Rectangle2D.Double fireField;    // the shootable battlefield<br></td></tr></table>
 <br><strong>Changed: 57c63</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
     static int[][][][][][][] aimFactors = new int[DISTANCE_INDEXES][VELOCITY_INDEXES][LAST_VELOCITY_INDEXES][DECCEL_TIME_INDEXES][WALL_INDEXES][WALL_INDEXES][AIM_FACTORS];<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
     static int[][][][][][] aimFactors = new int[DISTANCE_INDEXES][VELOCITY_INDEXES][LAST_VELOCITY_INDEXES][DECCEL_TIME_INDEXES][WALL_INDEXES][AIM_FACTORS];<br></td></tr></table>
 <br><strong>Changed: 64c70</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	setColors( Color.red, Color.blue, Color.yellow);<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         setColors( Color.red, Color.blue, Color.yellow);<br></td></tr></table>
 <br><strong>Changed: 66c72</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	fireField = new Rectangle2D.Double( WALL_MARGIN, WALL_MARGIN, getBattleFieldWidth<a href="robowiki@action=edit&id=BattleFieldWidth" class=wikipageedit>?</a>() - WALL_MARGIN * 2, getBattleFieldHeight<a href="robowiki@action=edit&id=BattleFieldHeight" class=wikipageedit>?</a>() - WALL_MARGIN * 2);<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         fireField = new Rectangle2D.Double( WALL_MARGIN, WALL_MARGIN, getBattleFieldWidth<a href="robowiki@action=edit&id=BattleFieldWidth" class=wikipageedit>?</a>() - WALL_MARGIN * 2, getBattleFieldHeight<a href="robowiki@action=edit&id=BattleFieldHeight" class=wikipageedit>?</a>() - WALL_MARGIN * 2);<br></td></tr></table>
 <br><strong>Changed: 68,75c74,81</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	// Let gun and radar move independently<br> 	set<a href="robowiki@AdjustGunForRobotTurn" class=wikipagelink>AdjustGunForRobotTurn</a>( true);<br> 	set<a href="robowiki@AdjustRadarForGunTurn" class=wikipagelink>AdjustRadarForGunTurn</a>( true);<br> <br> 	// mainloop<br> 	do {<br> 	    turnRadarRight<a href="robowiki@action=edit&id=RadarRight" class=wikipageedit>?</a>( Double.NEGATIVE_INFINITY);<br> 	} while(true);<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         // Let gun and radar move independently<br>         set<a href="robowiki@AdjustGunForRobotTurn" class=wikipagelink>AdjustGunForRobotTurn</a>( true);<br>         set<a href="robowiki@AdjustRadarForGunTurn" class=wikipagelink>AdjustRadarForGunTurn</a>( true);<br> <br>         // mainloop<br>         do {<br>             turnRadarRight<a href="robowiki@action=edit&id=RadarRight" class=wikipageedit>?</a>( Double.NEGATIVE_INFINITY);<br>         } while(true);<br></td></tr></table>
 <br><strong>Changed: 83,84c89,90</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	double tmpbearing = get<a href="robowiki@HeadingRadians" class=wikipagelink>HeadingRadians</a>() + e.getBearingRadians<a href="robowiki@action=edit&id=BearingRadians" class=wikipageedit>?</a>();<br> 	double turnAngle;<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         double tmpbearing = get<a href="robowiki@HeadingRadians" class=wikipagelink>HeadingRadians</a>() + e.getBearingRadians<a href="robowiki@action=edit&id=BearingRadians" class=wikipageedit>?</a>();<br>         double turnAngle;<br></td></tr></table>
 <br><strong>Changed: 86,87c92,93</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	// Lock target with radar<br> 	set<a href="robowiki@TurnRadarRightRadians" class=wikipagelink>TurnRadarRightRadians</a>( 2.2 * Utils.normal<a href="robowiki@RelativeAngle" class=wikipagelink>RelativeAngle</a>( tmpbearing - getRadarHeadingRadians<a href="robowiki@action=edit&id=RadarHeadingRadians" class=wikipageedit>?</a>()));<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         // Lock target with radar<br>         set<a href="robowiki@TurnRadarRightRadians" class=wikipagelink>TurnRadarRightRadians</a>( 2.2 * Utils.normal<a href="robowiki@RelativeAngle" class=wikipagelink>RelativeAngle</a>( tmpbearing - getRadarHeadingRadians<a href="robowiki@action=edit&id=RadarHeadingRadians" class=wikipageedit>?</a>()));<br></td></tr></table>
 <br><strong>Changed: 89,120c95,127</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	// perform Aristocles targeting<br> 	Wave wave = new Wave();<br> 	double enemyAbsoluteBearing<a href="robowiki@action=edit&id=AbsoluteBearing" class=wikipageedit>?</a> = get<a href="robowiki@HeadingRadians" class=wikipagelink>HeadingRadians</a>() + e.getBearingRadians<a href="robowiki@action=edit&id=BearingRadians" class=wikipageedit>?</a>();<br> 	enemyLocation = project(wave.wGunLocation<a href="robowiki@action=edit&id=GunLocation" class=wikipageedit>?</a> = new Point2D.Double(getX(), getY()), enemyAbsoluteBearing<a href="robowiki@action=edit&id=AbsoluteBearing" class=wikipageedit>?</a>, enemyDistance = e.getDistance());<br> <br> 	int lastVelocityIndex<a href="robowiki@action=edit&id=VelocityIndex" class=wikipageedit>?</a> = (int)Math.abs(enemyVelocity) / 2;<br> 	int velocityIndex = (int)Math.abs((enemyVelocity = e.getVelocity()) / 2);<br> 	if (velocityIndex &lt; lastVelocityIndex<a href="robowiki@action=edit&id=VelocityIndex" class=wikipageedit>?</a>) {<br> 	    timeSinceDeccel<a href="robowiki@action=edit&id=SinceDeccel" class=wikipageedit>?</a> = 0;<br> 	}<br> <br> 	if (enemyVelocity != 0) {<br> 	    bearingDirection = enemyVelocity * Math.sin(e.get<a href="robowiki@HeadingRadians" class=wikipagelink>HeadingRadians</a>() - enemyAbsoluteBearing<a href="robowiki@action=edit&id=AbsoluteBearing" class=wikipageedit>?</a>) &gt; 0 ?<br> 		0.7 / (double)MIDDLE_FACTOR : -0.7 / (double)MIDDLE_FACTOR;<br> 	}<br> 	wave.wBearingDirection<a href="robowiki@action=edit&id=BearingDirection" class=wikipageedit>?</a> = bearingDirection;<br> <br> 	int distanceIndex = (int)Math.min(DISTANCE_INDEXES - 1, enemyDistance / (MAX_DISTANCE / DISTANCE_INDEXES));<br> 	wave.wBulletPower<a href="robowiki@action=edit&id=BulletPower" class=wikipageedit>?</a> = enemyDistance &gt; 120 ? BULLET_POWER : MAX_BULLET_POWER;<br> <br> 	wave.wAimFactors<a href="robowiki@action=edit&id=AimFactors" class=wikipageedit>?</a> = aimFactors[distanceIndex][velocityIndex][lastVelocityIndex<a href="robowiki@action=edit&id=VelocityIndex" class=wikipageedit>?</a>][Math.min(DECCEL_TIME_INDEXES - 4, timeSinceDeccel<a href="robowiki@action=edit&id=SinceDeccel" class=wikipageedit>?</a>++ / 13)]<br> 	    [wallIndex(wave, 1)][wallIndex(wave, -1)];<br> <br> 	wave.wBearing = enemyAbsoluteBearing<a href="robowiki@action=edit&id=AbsoluteBearing" class=wikipageedit>?</a>;<br> <br> 	int mostVisited = MIDDLE_FACTOR, i = AIM_FACTORS;<br> 	do  {<br> 	    if (wave.wAimFactors<a href="robowiki@action=edit&id=AimFactors" class=wikipageedit>?</a>[--i] &gt; wave.wAimFactors<a href="robowiki@action=edit&id=AimFactors" class=wikipageedit>?</a>[mostVisited]) {<br> 		mostVisited = i;<br> 	    }<br> 	} while (i &gt; 0);<br> 	// end of Aristocles gun<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         // perform Aristocles targeting<br>         Wave wave = new Wave();<br>         double enemyAbsoluteBearing<a href="robowiki@action=edit&id=AbsoluteBearing" class=wikipageedit>?</a> = get<a href="robowiki@HeadingRadians" class=wikipagelink>HeadingRadians</a>() + e.getBearingRadians<a href="robowiki@action=edit&id=BearingRadians" class=wikipageedit>?</a>();<br>         enemyLocation = project(wave.wGunLocation<a href="robowiki@action=edit&id=GunLocation" class=wikipageedit>?</a> = new Point2D.Double(getX(), getY()), enemyAbsoluteBearing<a href="robowiki@action=edit&id=AbsoluteBearing" class=wikipageedit>?</a>, enemyDistance = e.getDistance());<br> <br>         int lastVelocityIndex<a href="robowiki@action=edit&id=VelocityIndex" class=wikipageedit>?</a> = (int)Math.abs(enemyVelocity) / 2;<br>         int velocityIndex = (int)Math.abs((enemyVelocity = e.getVelocity()) / 2);<br>         if (velocityIndex &lt; lastVelocityIndex<a href="robowiki@action=edit&id=VelocityIndex" class=wikipageedit>?</a>) {<br>             timeSinceDeccel<a href="robowiki@action=edit&id=SinceDeccel" class=wikipageedit>?</a> = 0;<br>         }<br> <br>         if (enemyVelocity != 0) {<br>             bearingDirection = enemyVelocity * Math.sin(e.get<a href="robowiki@HeadingRadians" class=wikipagelink>HeadingRadians</a>() - enemyAbsoluteBearing<a href="robowiki@action=edit&id=AbsoluteBearing" class=wikipageedit>?</a>) &gt; 0 ?<br>             0.7 / (double)MIDDLE_FACTOR : -0.7 / (double)MIDDLE_FACTOR;<br>         }<br>         wave.wBearingDirection<a href="robowiki@action=edit&id=BearingDirection" class=wikipageedit>?</a> = bearingDirection;<br> <br>         int distanceIndex = (int)Math.min(DISTANCE_INDEXES - 1, enemyDistance / (MAX_DISTANCE / DISTANCE_INDEXES));<br>         wave.wBulletPower<a href="robowiki@action=edit&id=BulletPower" class=wikipageedit>?</a> = enemyDistance &gt; BULLET_SWITCH_DISTANCE ? BULLET_POWER : MAX_BULLET_POWER;<br>         //wave.wBulletPower<a href="robowiki@action=edit&id=BulletPower" class=wikipageedit>?</a> = MAX_BULLET_POWER; // <a href="robowiki@TargetingChallenge" class=wikipagelink>TargetingChallenge</a><br> <br>         wave.wAimFactors<a href="robowiki@action=edit&id=AimFactors" class=wikipageedit>?</a> = aimFactors[distanceIndex][velocityIndex][lastVelocityIndex<a href="robowiki@action=edit&id=VelocityIndex" class=wikipageedit>?</a>][Math.min(DECCEL_TIME_INDEXES - 1, timeSinceDeccel<a href="robowiki@action=edit&id=SinceDeccel" class=wikipageedit>?</a>++ / 13)]<br>             [fireField.contains(project(wave.wGunLocation<a href="robowiki@action=edit&id=GunLocation" class=wikipageedit>?</a>, enemyAbsoluteBearing<a href="robowiki@action=edit&id=AbsoluteBearing" class=wikipageedit>?</a> + wave.wBearingDirection<a href="robowiki@action=edit&id=BearingDirection" class=wikipageedit>?</a> * 13, enemyDistance)) ? 1 : 0];<br> <br>         wave.wBearing = enemyAbsoluteBearing<a href="robowiki@action=edit&id=AbsoluteBearing" class=wikipageedit>?</a>;<br> <br>         int mostVisited = MIDDLE_FACTOR, i = AIM_FACTORS;<br>         do  {<br>             if (wave.wAimFactors<a href="robowiki@action=edit&id=AimFactors" class=wikipageedit>?</a>[--i] &gt; wave.wAimFactors<a href="robowiki@action=edit&id=AimFactors" class=wikipageedit>?</a>[mostVisited]) {<br>                 mostVisited = i;<br>             }<br>         } while (i &gt; 0);<br>         // end of Aristocles gun<br></td></tr></table>
 <br><strong>Changed: 122,123c129,130</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	// Turn gun (still Aristocles, but keep tmpbearing for movement)<br> 	tmpbearing = enemyAbsoluteBearing<a href="robowiki@action=edit&id=AbsoluteBearing" class=wikipageedit>?</a> + wave.wBearingDirection<a href="robowiki@action=edit&id=BearingDirection" class=wikipageedit>?</a> * (mostVisited - MIDDLE_FACTOR);<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         // Turn gun (still Aristocles, but keep tmpbearing for movement)<br>         tmpbearing = enemyAbsoluteBearing<a href="robowiki@action=edit&id=AbsoluteBearing" class=wikipageedit>?</a> + wave.wBearingDirection<a href="robowiki@action=edit&id=BearingDirection" class=wikipageedit>?</a> * (mostVisited - MIDDLE_FACTOR);<br></td></tr></table>
 <br><strong>Changed: 126,137c133,143</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	// Aristocles<br> 	setFire(wave.wBulletPower<a href="robowiki@action=edit&id=BulletPower" class=wikipageedit>?</a>);<br> 	if (getEnergy() &gt;= 0) {<br> 	    add<a href="robowiki@CustomEvent" class=wikipagelink>CustomEvent</a>(wave);<br> 	}<br> 	// GT: Move towards target<br> 	turnAngle = Utils.normal<a href="robowiki@RelativeAngle" class=wikipagelink>RelativeAngle</a>( tmpbearing - get<a href="robowiki@HeadingRadians" class=wikipagelink>HeadingRadians</a>());<br> 	setTurnRightRadians<a href="robowiki@action=edit&id=TurnRightRadians" class=wikipageedit>?</a>( Math.atan( Math.tan( turnAngle)));<br> 	setAhead( Double.POSITIVE_INFINITY * Math.cos( turnAngle));<br> <br> 	// Helps in melee to lock onto nearest target.<br> 	//		clearAllEvents<a href="robowiki@action=edit&id=AllEvents" class=wikipageedit>?</a>();<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         if (enemyDistance &lt;= (2 * BULLET_SWITCH_DISTANCE)) {<br>             setFire(wave.wBulletPower<a href="robowiki@action=edit&id=BulletPower" class=wikipageedit>?</a>);<br>         }<br>         // Aristocles<br>         if (getEnergy() &gt;= BULLET_POWER) {<br>             add<a href="robowiki@CustomEvent" class=wikipagelink>CustomEvent</a>(wave);<br>         }<br>         // GT: Move towards target<br>         turnAngle = Utils.normal<a href="robowiki@RelativeAngle" class=wikipagelink>RelativeAngle</a>( tmpbearing - get<a href="robowiki@HeadingRadians" class=wikipagelink>HeadingRadians</a>());<br>         setTurnRightRadians<a href="robowiki@action=edit&id=TurnRightRadians" class=wikipageedit>?</a>( Math.atan( Math.tan( turnAngle)));<br>         setAhead( Double.POSITIVE_INFINITY * Math.cos( turnAngle));<br></td></tr></table>
 <br><strong>Changed: 146,151c152,157</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	//Victory<a href="robowiki@action=edit&id=ARAMtocles/Victory" class=wikipageedit>?</a> dance	<br> 	set<a href="robowiki@TurnGunRight" class=wikipagelink>TurnGunRight</a>( Double.POSITIVE_INFINITY);<br> 	set<a href="robowiki@TurnRadarLeft" class=wikipagelink>TurnRadarLeft</a>( Double.POSITIVE_INFINITY);<br> 	setTurnRight<a href="robowiki@action=edit&id=TurnRight" class=wikipageedit>?</a>(10);<br> 	ahead(10);<br> 	waitFor(new RadarTurnCompleteCondition<a href="robowiki@action=edit&id=RadarTurnCompleteCondition" class=wikipageedit>?</a>(this));<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         //Victory<a href="robowiki@action=edit&id=ARAMtocles/Victory" class=wikipageedit>?</a> dance<br>         set<a href="robowiki@TurnGunRight" class=wikipagelink>TurnGunRight</a>( Double.POSITIVE_INFINITY);<br>         set<a href="robowiki@TurnRadarLeft" class=wikipagelink>TurnRadarLeft</a>( Double.POSITIVE_INFINITY);<br>         setTurnRight<a href="robowiki@action=edit&id=TurnRight" class=wikipageedit>?</a>(10);<br>         ahead(10);<br>         waitFor(new RadarTurnCompleteCondition<a href="robowiki@action=edit&id=RadarTurnCompleteCondition" class=wikipageedit>?</a>(this));<br></td></tr></table>
 <br><strong>Removed: 154d159</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 <br></td></tr></table>
 <br><strong>Changed: 157c162</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	return 20 - 3 * power;<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         return 20 - 3 * power;<br></td></tr></table>
 <br><strong>Changed: 161,162c166,167</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	return new Point2D.Double(sourceLocation.getX() + Math.sin(angle) * length,<br> 		sourceLocation.getY() + Math.cos(angle) * length);<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         return new Point2D.Double(sourceLocation.getX() + Math.sin(angle) * length,<br>             sourceLocation.getY() + Math.cos(angle) * length);<br></td></tr></table>
 <br><strong>Changed: 166,175c171</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	return Math.atan2(target.getX() - source.getX(), target.getY() - source.getY());<br>     }<br> <br>     static int wallIndex(Wave wave, double direction) {<br> 	int wallIndex = 0;<br> 	do {<br> 	    wallIndex++;<br> 	} while (wallIndex &lt; (WALL_INDEXES) &amp;&amp;<br> 	    fireField.contains(project(wave.wGunLocation<a href="robowiki@action=edit&id=GunLocation" class=wikipageedit>?</a>, wave.wBearing + direction * wave.wBearingDirection<a href="robowiki@action=edit&id=BearingDirection" class=wikipageedit>?</a> * (double)(wallIndex * 7.5), enemyDistance)));<br> 	return wallIndex - 1;<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
         return Math.atan2(target.getX() - source.getX(), target.getY() - source.getY());<br></td></tr></table>
 <br><strong>Changed: 179,197c175,193</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 	double wBulletPower<a href="robowiki@action=edit&id=BulletPower" class=wikipageedit>?</a>;<br> 	Point2D wGunLocation<a href="robowiki@action=edit&id=GunLocation" class=wikipageedit>?</a>;<br> 	double wBearing;<br> 	double wBearingDirection<a href="robowiki@action=edit&id=BearingDirection" class=wikipageedit>?</a>;<br> 	int[] wAimFactors<a href="robowiki@action=edit&id=AimFactors" class=wikipageedit>?</a>;<br> 	double wDistance;<br> <br> 	public boolean test() {<br> 	    if ((wDistance += bulletVelocity(wBulletPower<a href="robowiki@action=edit&id=BulletPower" class=wikipageedit>?</a>)) &gt; wGunLocation<a href="robowiki@action=edit&id=GunLocation" class=wikipageedit>?</a>.distance(enemyLocation) - 18) {<br> 		try {<br> 		    wAimFactors<a href="robowiki@action=edit&id=AimFactors" class=wikipageedit>?</a>[(int)Math.round(((Utils.normal<a href="robowiki@RelativeAngle" class=wikipagelink>RelativeAngle</a>(absoluteBearing(wGunLocation<a href="robowiki@action=edit&id=GunLocation" class=wikipageedit>?</a>, enemyLocation) - wBearing)) /<br> 				wBearingDirection<a href="robowiki@action=edit&id=BearingDirection" class=wikipageedit>?</a>) + MIDDLE_FACTOR)]++;<br> 		}<br> 		catch (Exception e) {<br> 		}<br> 		remove<a href="robowiki@CustomEvent" class=wikipagelink>CustomEvent</a>(this);<br> 	    }<br> 	    return false;<br> 	}<br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
     double wBulletPower<a href="robowiki@action=edit&id=BulletPower" class=wikipageedit>?</a>;<br>     Point2D wGunLocation<a href="robowiki@action=edit&id=GunLocation" class=wikipageedit>?</a>;<br>     double wBearing;<br>     double wBearingDirection<a href="robowiki@action=edit&id=BearingDirection" class=wikipageedit>?</a>;<br>     int[] wAimFactors<a href="robowiki@action=edit&id=AimFactors" class=wikipageedit>?</a>;<br>     double wDistance;<br> <br>     public boolean test() {<br>         if ((wDistance += bulletVelocity(wBulletPower<a href="robowiki@action=edit&id=BulletPower" class=wikipageedit>?</a>)) &gt; wGunLocation<a href="robowiki@action=edit&id=GunLocation" class=wikipageedit>?</a>.distance(enemyLocation) - 18) {<br>         try {<br>             wAimFactors<a href="robowiki@action=edit&id=AimFactors" class=wikipageedit>?</a>[(int)Math.round(((Utils.normal<a href="robowiki@RelativeAngle" class=wikipagelink>RelativeAngle</a>(absoluteBearing(wGunLocation<a href="robowiki@action=edit&id=GunLocation" class=wikipageedit>?</a>, enemyLocation) - wBearing)) /<br>                 wBearingDirection<a href="robowiki@action=edit&id=BearingDirection" class=wikipageedit>?</a>) + MIDDLE_FACTOR)]++;<br>         }<br>         catch (Exception e) {<br>         }<br>         remove<a href="robowiki@CustomEvent" class=wikipagelink>CustomEvent</a>(this);<br>         }<br>         return false;<br>     }<br></td></tr></table>
 <br><strong>Changed: 215c211,216</strong><br><table width="95%" bgcolor=#ffffaf class=wikidiffold><tr><td>
 It might. But to me it looks like most of the fight is carried at point blank. And then the circular prediction is 100% right while even one wrong guess from the learning gun will lower performance. (I've seen ARAMtocles miss while it looks to be ramming the opponent... The guns start heated so during the time it takes for the rammer to close in it can't fire anyway. Mayvbe I even should consider using linear or circular predictions in <a href="robowiki@CassiusClay" class=wikipagelink>CassiusClay</a> when I know I am dealing with a rammer. -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a><br></td></tr></table><table width="95%" bgcolor=#cfffcf class=wikidiffnew><tr><td>
 It might. But to me it looks like most of the fight is carried at point blank. And then the circular prediction is 100% right while even one wrong guess from the learning gun will lower performance. (I've seen ARAMtocles miss while it looks to be ramming the opponent... The guns start heated so during the time it takes for the rammer to close in it can't fire anyway. Mayvbe I even should consider using linear or circular predictions in <a href="robowiki@CassiusClay" class=wikipagelink>CassiusClay</a> when I know I am dealing with a rammer. -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a><br> <br> The newest version basically goes back to v0.1, but with improved distance segmenting and bulletpower. It should at least end up around rating 1615. Further development (if any) will be done with the <a href="robowiki@RambotChallenge2K6" class=wikipagelink>RambotChallenge2K6</a>. A specialized GF-gun should be able to handle short rammer matches.  -- <a href="robowiki@GrubbmGait" class=wikipagelink>GrubbmGait</a><br> <br> I should not fiddle with things I know nothing about. In my tests over 500 rounds ARAMtocles 0.3 humiliates every other rambot, but over 35 rounds it gets kicked in the butt. Till now <a href="robowiki@CircularTargeting" class=wikipagelink>CircularTargeting</a> seems unbeatable at close ranges.  -- <a href="robowiki@GrubbmGait" class=wikipagelink>GrubbmGait</a><br> <br></td></tr></table>
<hr class=wikilinediff>
<div class=wikitext><center>
<H2>ARAMtocles</H2>

<p>
By <a href="robowiki@GrubbmGait" class=wikipagelink>GrubbmGait</a> and <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
</center>
<p>
<H3>What is it?</H3>

A <a href="robowiki@MicroBot" class=wikipagelink>MicroBot</a>. The result of using <a href="robowiki@Aristocles" class=wikipagelink>Aristocles</a>'s gun on the mean <a href="robowiki@RamBot" class=wikipagelink>RamBot</a> <a href="robowiki@GrubbmThree" class=wikipagelink>GrubbmThree</a>
<p>
It can be found here: <a rel="nofollow" href="http://www.robocoderepository.com/BotDetail.jsp@id=2864">http://www.robocoderepository.com/BotDetail.jsp?id=2864</a>
<p>
<H3>History</H3>

<p>
<UL >
<li> 0.3: rating 1598 (<a href="robowiki@NanoDeath" class=wikipagelink>NanoDeath</a> - 22)
<li> 0.2: rating 1599 (<a href="robowiki@NanoDeath" class=wikipagelink>NanoDeath</a> - 21)
<li> 0.1: rating 1608 (<a href="robowiki@NanoDeath" class=wikipagelink>NanoDeath</a> - 12)
</UL>
<p>
<H3>Code</H3>

<a href="robowiki@RWPCL" class=wikipagelink>RWPCL</a> applies.
<p>
<pre>
package wiki.micro;
import robocode.*;
import robocode.util.Utils;
import java.awt.Color;
import java.awt.geom.*;
/**
 * ARAMtocles - ramming with GuessFactors
 * Gunnery of Aristocles by PEZ
 * rest of GrubbmThree by GrubbmGait (but that turns out to be very little)
 * RWPCL applies
 *
 * Revision information:
 * v0.1 20060213 Initial version, shrunk GrubbmThree and GF-gun of Aristocles.
 *               No tuning of segmentation. 726 bytes
 * v0.2 20060213 Added reverse wall segmentation. Lowered the granularity in general to 
 *               accomodate to the short learning times ramming gives you. 732 bytes
 * v0.3 20060217 Removed reverse wall stuff.
 *               Rearranged distance segmentation and bulletpower. 707 bytes
 */
public class ARAMtocles extends AdvancedRobot
{
    static final double MAX_DISTANCE = 450;
    static final double BULLET_SWITCH_DISTANCE = 180;
    static final double MAX_BULLET_POWER = 3.0;       // first two distance segments
    static final double BULLET_POWER = 1.9;           // third and fourth distance segment
    static final double WALL_MARGIN = 18;

    static final int DISTANCE_INDEXES = 5;
    static final int VELOCITY_INDEXES = 5;
    static final int LAST_VELOCITY_INDEXES = 5;
    static final int WALL_INDEXES = 2;
    static final int DECCEL_TIME_INDEXES = 5;
    static final int AIM_FACTORS = 25;
    static final int MIDDLE_FACTOR = (AIM_FACTORS - 1) / 2;

    static Rectangle2D.Double fireField;    // the shootable battlefield
    static Point2D enemyLocation;
    static double enemyVelocity;
    static int timeSinceDeccel;
    static double bearingDirection;
    static double enemyDistance;
    static int[][][][][][] aimFactors = new int[DISTANCE_INDEXES][VELOCITY_INDEXES][LAST_VELOCITY_INDEXES][DECCEL_TIME_INDEXES][WALL_INDEXES][AIM_FACTORS];

    /**
     * run: ARAMtocles default behavior
     */
    public void run() {

        setColors( Color.red, Color.blue, Color.yellow);

        fireField = new Rectangle2D.Double( WALL_MARGIN, WALL_MARGIN, getBattleFieldWidth() - WALL_MARGIN * 2, getBattleFieldHeight() - WALL_MARGIN * 2);

        // Let gun and radar move independently
        setAdjustGunForRobotTurn( true);
        setAdjustRadarForGunTurn( true);

        // mainloop
        do {
            turnRadarRight( Double.NEGATIVE_INFINITY);
        } while(true);
    }

    /**
     * onScannedRobot: What to do when you see another robot
     */
    public void onScannedRobot(ScannedRobotEvent e) {

        double tmpbearing = getHeadingRadians() + e.getBearingRadians();
        double turnAngle;

        // Lock target with radar
        setTurnRadarRightRadians( 2.2 * Utils.normalRelativeAngle( tmpbearing - getRadarHeadingRadians()));

        // perform Aristocles targeting
        Wave wave = new Wave();
        double enemyAbsoluteBearing = getHeadingRadians() + e.getBearingRadians();
        enemyLocation = project(wave.wGunLocation = new Point2D.Double(getX(), getY()), enemyAbsoluteBearing, enemyDistance = e.getDistance());

        int lastVelocityIndex = (int)Math.abs(enemyVelocity) / 2;
        int velocityIndex = (int)Math.abs((enemyVelocity = e.getVelocity()) / 2);
        if (velocityIndex &lt; lastVelocityIndex) {
            timeSinceDeccel = 0;
        }

        if (enemyVelocity != 0) {
            bearingDirection = enemyVelocity * Math.sin(e.getHeadingRadians() - enemyAbsoluteBearing) &gt; 0 ?
            0.7 / (double)MIDDLE_FACTOR : -0.7 / (double)MIDDLE_FACTOR;
        }
        wave.wBearingDirection = bearingDirection;

        int distanceIndex = (int)Math.min(DISTANCE_INDEXES - 1, enemyDistance / (MAX_DISTANCE / DISTANCE_INDEXES));
        wave.wBulletPower = enemyDistance &gt; BULLET_SWITCH_DISTANCE ? BULLET_POWER : MAX_BULLET_POWER;
        //wave.wBulletPower = MAX_BULLET_POWER; // TargetingChallenge

        wave.wAimFactors = aimFactors[distanceIndex][velocityIndex][lastVelocityIndex][Math.min(DECCEL_TIME_INDEXES - 1, timeSinceDeccel++ / 13)]
            [fireField.contains(project(wave.wGunLocation, enemyAbsoluteBearing + wave.wBearingDirection * 13, enemyDistance)) ? 1 : 0];

        wave.wBearing = enemyAbsoluteBearing;

        int mostVisited = MIDDLE_FACTOR, i = AIM_FACTORS;
        do  {
            if (wave.wAimFactors[--i] &gt; wave.wAimFactors[mostVisited]) {
                mostVisited = i;
            }
        } while (i &gt; 0);
        // end of Aristocles gun

        // Turn gun (still Aristocles, but keep tmpbearing for movement)
        tmpbearing = enemyAbsoluteBearing + wave.wBearingDirection * (mostVisited - MIDDLE_FACTOR);
        setTurnGunRightRadians( Utils.normalRelativeAngle( tmpbearing - getGunHeadingRadians()));

        if (enemyDistance &lt;= (2 * BULLET_SWITCH_DISTANCE)) {
            setFire(wave.wBulletPower);
        }
        // Aristocles
        if (getEnergy() &gt;= BULLET_POWER) {
            addCustomEvent(wave);
        }
        // GT: Move towards target
        turnAngle = Utils.normalRelativeAngle( tmpbearing - getHeadingRadians());
        setTurnRightRadians( Math.atan( Math.tan( turnAngle)));
        setAhead( Double.POSITIVE_INFINITY * Math.cos( turnAngle));
    }


    /**
     * onWin: Show my private victory dance
     */
    public void onWin(WinEvent e)
    {
        //Victory dance
        setTurnGunRight( Double.POSITIVE_INFINITY);
        setTurnRadarLeft( Double.POSITIVE_INFINITY);
        setTurnRight(10);
        ahead(10);
        waitFor(new RadarTurnCompleteCondition(this));
    }

    // Aristocles: helperfunctions and so
    static double bulletVelocity(double power) {
        return 20 - 3 * power;
    }

    static Point2D project(Point2D sourceLocation, double angle, double length) {
        return new Point2D.Double(sourceLocation.getX() + Math.sin(angle) * length,
            sourceLocation.getY() + Math.cos(angle) * length);
    }

    static double absoluteBearing(Point2D source, Point2D target) {
        return Math.atan2(target.getX() - source.getX(), target.getY() - source.getY());
    }

    class Wave extends Condition {
    double wBulletPower;
    Point2D wGunLocation;
    double wBearing;
    double wBearingDirection;
    int[] wAimFactors;
    double wDistance;

    public boolean test() {
        if ((wDistance += bulletVelocity(wBulletPower)) &gt; wGunLocation.distance(enemyLocation) - 18) {
        try {
            wAimFactors[(int)Math.round(((Utils.normalRelativeAngle(absoluteBearing(wGunLocation, enemyLocation) - wBearing)) /
                wBearingDirection) + MIDDLE_FACTOR)]++;
        }
        catch (Exception e) {
        }
        removeCustomEvent(this);
        }
        return false;
    }
    }
}
</pre>
<p>
<H3>Comments</H3>

Grub, I've tried to tune the segmentations some. Mainly it was about narrowing down the distance segmentation and also using less granularity. (There's not much time to learn during a ram fight.) I also added a reverse wall segmentation, which I am not sure it helps much now that I have watched a few fights with this bot. But anyway. Can you pack this up and release on the rumble for test? -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
Its up, lets see if can do some more damage.  -- <a href="robowiki@GrubbmGait" class=wikipagelink>GrubbmGait</a>
<p>
Again it doesn't look too promising. It could be something is buggy with the gun now, but probably it just means the gun just isn't cut for dealing with the extreme fast learning needed here. And at those fighting distances the circular targeting might just be better than bothering with stats. -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
I think you are right, each battle only lasts between 100 and 200 ticks, so there is almost no time for learning. I expected ARAMtocles to be an improvement against the better anti-rammers as running away seems quite predictable, but it seems that that can not compensate the lesser performance in the first rounds.  -- <a href="robowiki@GrubbmGait" class=wikipagelink>GrubbmGait</a>
<p>
This is a bit dissapointing, but I can't make this work even with low segmentation it seems. Poor ARAM seems to be a poor rammer compared to its ancestor and <a href="robowiki@MaxRisk" class=wikipagelink>cousin</a>. I say we remove it from the rumble until we have some more ideas on how to make it work. -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
PEZ, maybe an advancing velocity segment would be useful in this bot? It seems that a rammer might create exploitable behaviour in that dimension (since the enemy will most likely be moving away from you). Just a thought. --<a href="robowiki@Wcsv" class=wikipagelink>wcsv</a>
<p>
It might. But to me it looks like most of the fight is carried at point blank. And then the circular prediction is 100% right while even one wrong guess from the learning gun will lower performance. (I've seen ARAMtocles miss while it looks to be ramming the opponent... The guns start heated so during the time it takes for the rammer to close in it can't fire anyway. Mayvbe I even should consider using linear or circular predictions in <a href="robowiki@CassiusClay" class=wikipagelink>CassiusClay</a> when I know I am dealing with a rammer. -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
The newest version basically goes back to v0.1, but with improved distance segmenting and bulletpower. It should at least end up around rating 1615. Further development (if any) will be done with the <a href="robowiki@RambotChallenge2K6" class=wikipagelink>RambotChallenge2K6</a>. A specialized GF-gun should be able to handle short rammer matches.  -- <a href="robowiki@GrubbmGait" class=wikipagelink>GrubbmGait</a>
<p>
I should not fiddle with things I know nothing about. In my tests over 500 rounds ARAMtocles 0.3 humiliates every other rambot, but over 35 rounds it gets kicked in the butt. Till now <a href="robowiki@CircularTargeting" class=wikipagelink>CircularTargeting</a> seems unbeatable at close ranges.  -- <a href="robowiki@GrubbmGait" class=wikipagelink>GrubbmGait</a>
<p>
</div><hr class=wikilinefooter>
<div class=wikifooter><form method="post" action="robowiki" enctype="application/x-www-form-urlencoded">
<a href="robowiki@Robo_Home" class=wikipagelink>Robo Home</a> | <a href="robowiki@Changes" class=wikipagelink>Changes</a> | <a href="robowiki@action=editprefs">Preferences</a> | <a href='?action=index'>AllPages</a><br>
<a href="robowiki@action=edit&id=ARAMtocles" class=wikipageedit>Edit text of this page</a> | <a href="robowiki@action=history&id=ARAMtocles">View other revisions</a><br>Last edited February 20, 2006 10:37 EST by <a href="robowiki@GrubbmGait" title="ID 3539 from styx18.ict.nl">GrubbmGait</a> <a href="robowiki@action=browse&diff=1&id=ARAMtocles">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /></form></div>
</body>
</html>