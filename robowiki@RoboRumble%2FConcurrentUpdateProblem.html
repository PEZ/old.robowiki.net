<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML><HEAD><TITLE>RoboRumble/ConcurrentUpdateProblem - Robo Wiki -= Collecting Robocode Knowledge =-</TITLE>
<META NAME='KEYWORDS' CONTENT='Robo, Rumble, Concurrent, Update, Problem'/>
<LINK REL="stylesheet" HREF="/robodocs/wiki.css">
</HEAD><BODY BGCOLOR="white">
<div class=wikiheader><h1><a href="robowiki@Robo_Home"><img src="/images/RoboWiki.png" alt="[Home]" border=0 align="right"></a><a href="robowiki@back=/ConcurrentUpdateProblem">RoboRumble/ConcurrentUpdateProblem</a></h1><a href="robowiki@Robo_Home" class=wikipagelink>Robo Home</a> | <a href="robowiki@RoboRumble" class=wikipagelink>RoboRumble</a> | <a href="robowiki@Changes" class=wikipagelink>Changes</a> | <a href="robowiki@action=editprefs">Preferences</a> | <a href='?action=index'>AllPages</a><br>
<hr class=wikilineheader></div><div class=wikitext>Currently all robocode clients risk updating the same server files at once. This leads to all sorts of problems and must be fixed soon or we won't know if other problems are related or not. I'll start working with this on Saturday if noone else has started before that? Whoever wants to try fix the problem (<a href="robowiki@Vuen" class=wikipagelink>Vuen</a>?). Download the server classes and implement some per-file queue for updates and reads in the class DataManager. It's a Singleton instance used to read and write files by all other servlets. The writing servlets implement SingleThreadedModel which means we have a pool of these servlets each with a reference to this Singleton data manager. A naïve solution would be to just "synchronize" the update/read methods. But that would stall the data manager even when it's not necessary. The locking should be based on the file being updated/read. -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
Cool. I'd love to help, but unfortunately I'll be out of the loop for a few days; I have several assignments to do due tomorrow, an assignment due in an hour and a half, and I'll be out of town till saturday night; the latest I'd be able to start is sunday, but I have a test and a midterm exam next week. Unfortunately I can't participate now, but hopefully soon when I catch up in my classes I'll have more free time to work on Fractal and RR@H. -- <a href="robowiki@Vuen" class=wikipagelink>Vuen</a>
<p>
OK, this is for the record. I've made an implementation of a data manager that should prevent the concurrent updates. Though it's a bit trickier than I had thought and I'm not sure I've got it right. I've sent it to <a href="robowiki@Albert" class=wikipagelink>Albert</a> for review. If someone feels comfortable with this sort of multithreaded programming please let us know. -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
Now we have the updated data manager class deployed. Please try to observe the output from the RR@H client a little closer than usual and report any problems obeserved here. If the update should cause the updates to fail totally, no worries. Things at least should fail reliably and the client will upload the data once the server is fixed. -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
Albert, we still have that .5 at the end of the battle count. Is there some way I can clean the data files on the server to get rid of this? Also, the battles_roborumble.txt file is 15 megs in size. I might have asked this before; will it grow much more than that? -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
The battles_roborumble file will grow up and up. It logs all the records received by the file. Just delete it, it will not harm anything. I'w take a closer look into the .5 (I'm thinking it can happen even if the updates are OK). -- <a href="robowiki@Albert" class=wikipagelink>Albert</a>
<p>
I've been doing some experiments with the allpairings.zip file, I don't know if it is somehow related to the .5, but there are allways 5 invalid records... -- <a href="robowiki@ABC" class=wikipagelink>ABC</a>
</div><hr class=wikilinefooter>
<div class=wikifooter><form method="post" action="robowiki" enctype="application/x-www-form-urlencoded">
<a href="robowiki@Robo_Home" class=wikipagelink>Robo Home</a> | <a href="robowiki@RoboRumble" class=wikipagelink>RoboRumble</a> | <a href="robowiki@Changes" class=wikipagelink>Changes</a> | <a href="robowiki@action=editprefs">Preferences</a> | <a href='?action=index'>AllPages</a><br>
<a href="robowiki@action=edit&id=RoboRumble/ConcurrentUpdateProblem" class=wikipageedit>Edit text of this page</a> | <a href="robowiki@action=history&id=RoboRumble/ConcurrentUpdateProblem">View other revisions</a><br>Last edited September 29, 2003 20:20 EST by <a href="robowiki@ABC" title="ID 1144 from a212-113-164-101.netcabo.pt">ABC</a> <a href="robowiki@action=browse&diff=1&id=RoboRumble/ConcurrentUpdateProblem">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /></form></div>
</body>
</html>