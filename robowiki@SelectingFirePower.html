<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML><HEAD><TITLE>SelectingFirePower - Robo Wiki -= Collecting Robocode Knowledge =-</TITLE>
<META NAME='KEYWORDS' CONTENT='Selecting, Fire, Power'/>
<LINK REL="stylesheet" HREF="/robodocs/wiki.css">
</HEAD><BODY BGCOLOR="white">
<div class=wikiheader><h1><a href="robowiki@Robo_Home"><img src="/images/RoboWiki.png" alt="[Home]" border=0 align="right"></a><a href="robowiki@back=SelectingFirePower">SelectingFirePower</a></h1><a href="robowiki@Robo_Home" class=wikipagelink>Robo Home</a> | <a href="robowiki@Changes" class=wikipagelink>Changes</a> | <a href="robowiki@action=editprefs">Preferences</a> | <a href='?action=index'>AllPages</a><br>
<hr class=wikilineheader></div><div class=wikitext>Choosing the right fire power can make the difference. For example, Aspid has a tendency to survive less than his enemies because it always fires with power 3, so it wastes lots of energy (well, the good part is that he does lots of damage).
<p>
My personal opinion is: If you don't know which power to fire, fire power 3. It will hurt more if you are good hitting your enemy, or it will lower your energy as soon as possible if you are not good at it (thus reducing the maximum bullet damage the enemy can score). Of course, it is valid only for 1vs1 (maybe it is true also for melee, but I don't know).
<p>
<b> When do I fire? </b>
<p>
It seems clear that it makes no sense to fire if you are not going to hit. But where is this limit? Which is the minimum expected probability necessary to make a shot profitable?
<p>
The easier way is to model it is as a gain function:
<p>
<PRE >
 G = (4p + 2(p-1))*a + 3p*a - p //p is the power of your bullet, and a the expected probability to hit
</PRE>
<p>
The first term is the energy the enemy loses (assuming you fire a bullet with power (1..3)), the second one the energy you gain by hitting, and the 3rd one is the energy you lose by firing. Not that if the gain is greater than 0, then you expect to gain some energy (relative to your enemy). If lower than 0, you expect to lose some energy. Now, you zero it to get the minimum probability.
<p>
<PRE >
 G = 0 = (4p + 2(p-1))*a + 3p*a - p ==&gt; a = p / (9p-2)
</PRE>
<p>
The minimum probabilities are 12% (power 3), 12.5% (power 2) and 14.2% (power 1). Note that you expect to get more energy when the bullet is more powerful. For example, you will fire a power 3 bullet if the expected probability is 13%, but you will not fire a power 1 bullet if the probability is 13%.
<p>
Note that the previous function is only good for 1vs1. The previous strategy can lead to a situation where your energy level goes down (simply because it makes the enemy energy level to fall faster than yours), but you probably don't want it in meele. The following function is probably more appropiate for meele:
<p>
<PRE >
 G = 3p*a - p ==&gt; a = 1/3 = 33% (note that it is independent from fire power).
</PRE>
<p>
<b> Which fire power do I use? </b>
<p>
Well, now things get more confusing. First of all, the probability to hit is related to the fire power. Second, you have to take into account that the enemy is firing at you, so may be the most energy-efficient strategy is not the best strategy...
<p>
Currently, the only bots of mine that use a fire power selection strategy are Mamba's. Depending on the version, they maximize the following functions.
<p>
<UL >
<li> The energy gain per time unit.
<li> The energy gain per power unit fired.
</UL>
<p>
<b> Calculating energy gain per time unit </b>
<p>
To calculate this gain, the approach is similar to the one used previously. You simply have to add a factor to take into account that a higher power means less shots (because you need more time to cool down your gun) and also that the probability to hit is a function of the power you use (you should also consider the distance, but of course, you are taking the decision for a given distance, so what you need is to keep statistics for different ranges).
<p>
<PRE >
 G = (9 * p * a(p) - 2 * a(p) - p) * (1/(10+2*p)) //a(p) is the probability to hit based on the power used
</PRE>
<p>
Note that this function is almost the same one used before, but multiplied by the inverse of the number of turns you will need to cool down your gun.
<p>
a(p) is unknown, so we have to estimate it. The easier way is to make a linear approach like this:
<p>
<PRE >
 a(p) = a - b * p 
 a is the probability to hit with a bullet of power 0 (ie. of velocity 20).
 b is the decrease in the probability by increasing the fire power by 1.
 Example: If you have a probability to hit of 30% with fire power 1 and of 10% with fire power 3, then a = 0.4 and b = 0.1
</PRE>
<p>
You can collect data from your previous shots and easily calculate this parameters.
<p>
Now, the easiest way to calculate the best fire power is to iterate some values of fire power (ie. from 1 to 3, steps = 0.5) and to select the one with higher gains.
<p>
Another way, more accurate, is to calculate the máximum of this function by derivating and finding the zeros of the derivative. I'w not do it here (I posted a link in <a href="robowiki@Math" class=wikipagelink>Math</a> section that does it for you, but I'w post the final formula.
<p>
<PRE >
 Best Power = p = [(2b+9a-1) + Sqrt((1-9a-2b)^2 - 4*9b*2a)] / (2*9b)
 Note that this function can have result higher than 3 (use 3 instead) or lower than 1 (remember that G has a range for p = (1..3)).
</PRE>
<p>
As an example, for a = 0.4 and b = 0.1 the best firepower is 2.79. 
<hr noshade class=wikiline size=1>
Although the above is a bit too much rocket science to my taste, it's still one of the single most important articles I've read when it relates to the evolution of <a href="robowiki@Marshmallow" class=wikipagelink>Marshmallow</a>. The second I started to fire harder I also started to win many more matches. Simple as that. Yet, putting Marshmallow up against <a href="robowiki@Aspid" class=wikipagelink>Aspid</a> I notice that even when Marshmallow succeeds in being last survivor more often than Aspid it looses the bullet damage game and as a result often the whole match. Now I wonder:
<UL >
<li> Does bullet damage always give damage points according to the formula 4p + 2(p-1)? I have up until now just assumed you only got points for the energy the enemy has left.
</UL>
This is very much related to <a href="robowiki@ManagingEnergy" class=wikipagelink>ManagingEnergy</a> -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
<hr noshade class=wikiline size=1>
You do get points according to that formula, I think. Also, when you kill a bot you get bonus points in relation to how much damage you have done to that bot.
<p>
In a competition situation it might pay off to implement a strategy to deny the other bot points by wasting energy. In melee it might be important to kill off bots, both to get the bonus and to deny other bots the bonus.
<p>
In one-on-one SurvivalBattles<a href="robowiki@action=edit&id=SurvivalBattles" class=wikipageedit>?</a> it is much easier to calculate the fire power to be used. You should fire so that you hit one shot out of eight. This fact is used in <a href="robowiki@Pandora" class=wikipagelink>Pandora</a> which is a <a href="robowiki@PerceptualBot" class=wikipagelink>PerceptualBot</a> designed for SurvivalBattles<a href="robowiki@action=edit&id=SurvivalBattles" class=wikipageedit>?</a> and uses RandomFiring<a href="robowiki@action=edit&id=RandomFiring" class=wikipageedit>?</a>.
<p>
In <a href="robowiki@Relativity" class=wikipagelink>Relativity</a>, the primary tuning factor for firing is the time in flight of the bullet, which is closely related to the hit probability. The desired flight time of the bullet is then adjusted for each hit and for each miss so that the hit-rate stabilizes at the desired ratio.
<p>
In ordinary battles for points, the general rule discovered by Stuart Holliday is "always fire 3". This is probably not entirely correct, but given that you get bonus points for damage done and also deny the other bot points by wasting your own energy, the rule holds fairly well.
--<a href="robowiki@Tobe" class=wikipagelink>tobe</a>
<p>
Yngwie (winner of the original Robocode Rumble) observed that it's generally a waste of energy (especially in melee) to fire a bullet that is more powerful than can finish its target off.  It fired a lot, and fairly confidently, but it was still interested in not wasting energy.  Just for the sake of simplicity, I don't figure out the exact bound, but I fire no more than 1/4 of my opponent's energy.  As a survivalist, I don't ever fire harder than 1/5 of my own energy, either (or .1 if that's all I have left).  -- <a href="robowiki@Kawigi" class=wikipagelink>Kawigi</a>
<p>
If you want, the exact solution is something like this:
<PRE >
 bulletPower = Math.min(bulletPower, event.getEnergy() &gt;= 4 ? (event.getEnergy() + 2) / 6 : event.getEnergy() / 4);
</PRE>
--<a href="robowiki@Nano" class=wikipagelink>nano</a>
<p>
Actually, if there is no previous bias to the bulletPower, it seems to be this (eliminating the Math.min part):
bulletPower = (event.getEnergy() &gt; 4) ? (event.getEnergy()-6)/10:event.getEnergy()/4;
Does that sound right at all?  I'm taking damage = 4*power+(power-1)*6 and solving for power.
--<a href="robowiki@Kawigi" class=wikipagelink>Kawigi</a>
<p>
I believe the equation for power &gt; 1 is damage = 4 * power + 2 * (power - 1), taken from the <a rel="nofollow" href="http://robocode.alphaworks.ibm.com/help/robocode.faq.txt">[Robocode FAQ]</a>.
Therefore, the solution for power &gt; 1 (damage &gt; 4) is: power = (damage + 2) / 6.
--<a href="robowiki@Nano" class=wikipagelink>nano</a>
<p>
Ah, my (power-1)*6 is part of my conception of 6=4+2 (it should be 2, and 4 is what power was already multiplied by).  My mistake :-p
--<a href="robowiki@Kawigi" class=wikipagelink>Kawigi</a>
<p>
In my test league that I'm running with the dev version of <a href="robowiki@FloodHT" class=wikipagelink>FloodHT</a> right now, if all ER rankings depended on how you did against the 'hourly build' of <a href="robowiki@FloodHT" class=wikipagelink>FloodHT</a>, Marshmallow would be staying at 6th, or if only the latest build counts, Marshmallow would be king of the ER.  It appears that 1.7 still doesn't have as good of movement against more conservatively-powered bullets.  Of course, that's just based on my experiments with bullet power/energy management.  With a very survivalist system I tried, I did better against Chameleon, <a href="robowiki@CigaretBH" class=wikipagelink>CigaretBH</a>, Marshmallow, Tron and Princess, but with a more damage-oriented system I tried, I did better against DT, <a href="robowiki@FloodMini" class=wikipagelink>FloodMini</a>, Cigaret, and <a href="robowiki@GlowBlowAPM" class=wikipagelink>GlowBlowAPM</a>.  The margin of difference seemed to favor the more aggressive system.  I'm trying using a system that is fairly middle-of-the-road (after trying to intelligently choose one or the other, that didn't work incredibly well), but still somewhat aggressive.  I'm still running tests on it, but it appears to be even better against DT and Chameleon, but worse against Marshmallow, who may be well on its way to being the biggest drag on the next version of <a href="robowiki@FloodHT" class=wikipagelink>FloodHT</a>'s rating.  It appears that another factor that should go into play with selecting fire power is whether the author of the robot used <a href="robowiki@StatistRobot" class=wikipagelink>StatistRobot</a> and <a href="robowiki@SmogPainter" class=wikipagelink>SmogPainter</a> to assist in tweaking the movement.  If they did, fire lower-powered bullets, because they have great movement against power-3 bullets :-p -- <a href="robowiki@Kawigi" class=wikipagelink>Kawigi</a>
<p>
Maybe it's time for something like DynamicFirePower<a href="robowiki@action=edit&id=DynamicFirePower" class=wikipageedit>?</a>. That way your bot would be able to capture M's weakness for weaker bullets while being able to gain the advantages of shooting hard against many of the top ER bots. I can't try it with M since it would slow down its learning rate even more... -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
Exactly the problem.  One observation is that it can be good to use my energy-conserving system if both robots' hit rates are extremely low.  That way my energy goes down slower and I have the advantage at the end of the round when neither of us have hit each other ;-)  But that logic doesn't seem to stand completely.  I'd actually be interested in seeing some of the logic that DT uses for selecting fire power, since he seems to use a pretty arbitrary selection. -- <a href="robowiki@Kawigi" class=wikipagelink>Kawigi</a>
<hr noshade class=wikiline size=1>
The optimal fire power is about 1.72 something I think. -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
Is that optimal for like, how to put out energy the fastest? I am really clueless when it comes to deciding firepower. I'll go read up more on deciding firepower and see what I can come up with... -- <a href="robowiki@Vuen" class=wikipagelink>Vuen</a>
<p>
=) I am pretty clueless myself. Some month ago I started to figure about it and draw some curves on bullet damage in relation to max escape angle. This is the graph:
<p>
<img src="http:/robocode/uploads/pez/OptimizingBulletPower.png">
<p>
It suggests that after 1.72 something you start to get harder to hit the enemy in relation to how much you can gain on hitting it. I think. What's your thoughts on the graphs story? -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
Well, my thoughts are that your graph assumes a movement that's Flat with Flat juice on top no matter how you split it up.  What if your targeting algorithm is more likely than just random to hit? -- <a href="robowiki@Kawigi" class=wikipagelink>Kawigi</a>
<p>
I totally agree with Kawigi. Besides, there is whole 'game theory' related issue. What would change if survival bonus was 200? Or damage bonus 45% instead of 20% ? When to start endgame and limit your shooting power even more? When to delay shooting to conserve power? Your solution is 'one fits all', probably good against flat movement and game where bots start with 10000 power. -- <a href="robowiki@Frakir" class=wikipagelink>Frakir</a>
<p>
I don't quite follow. What <em>if</em> my algorithm is better than just random? I haven't proposed a solution. (Unless you count the not-so-seriously-intended "optimal fore power 1.72. =) I just want to hear what you think is the conclusions one could draw from the graph's story, The graph does not assume anything really. It's just probabilities I guess. Selecting fire power is tricky. You need payback on power consumed, right? Let's say you start out with 1.7 while you don't know anything about your enemy's movement. And then you can adjust this if you find out you can get payback enough with another power level in certain segments. I'm just brainstorming here. -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
What might be more significant here is figuring out what your <em>actual</em> chances are of hitting at the current distance in the current direction at the chosen bearing, and see if such a graph would show a different optimal value for you in that specific situation.  After that, the only thing you have to worry about is if the answer is not time efficient, which I suspect is a minor issue, particularly if your movement is remotely good. -- <a href="robowiki@Kawigi" class=wikipagelink>Kawigi</a>
<p>
But such a graph could be expressed as a deviation from the general graph above, right? In <a href="robowiki@Marshmallow" class=wikipagelink>Marshmallow</a> I have the kind of stats you suggest I think (rating the <a href="robowiki@VirtualGuns" class=wikipagelink>VirtualGuns</a>). How would I deduce from that what bullet power I should choose? I don't understand the part about time efficency. Can you elaborate some? -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
I think you could use VG stats for this, or it may make sense to keep more detailed stats (or more segmented stats) than you use to choose VG's.  The way to deduce bullet power is to figure out at what power the greatest margin of benefit is.  For example, if you have probability of hitting with a certain power is <tt>p</tt>, the margin of benefit of firing at that power (assuming a 1-on-1 battle) is <tt>(your gain in energy + their loss in energy-power)*p-power*(1-p)</tt>.  Basically, the potential "net gain" from hitting times the probability of hitting minus the potential loss times the probability of missing.
<p>
The time efficiency I was referring to is maybe some lower power is more beneficial by this definition, but a higher power would still be almost as good, and if you always fire at a lower power, your opponent may win because they just finish killing you faster by using higher-powered bullets. -- <a href="robowiki@Kawigi" class=wikipagelink>Kawigi</a>
<p>
I knew this would quickly become rocket science. One size fits all isn't too bad I think. At least as long as you haven't collected enough data to apply the brain surgery on. Quite often before the advice for people who don't want to introduce complexety here has been to shoot with power 3 here. Just maybe it is better to shot, say, 2.2 instead? -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
Maybe.  The main disadvantage of the method that I discribed above is that it may require too many additional calculations to be worth it.  The idea, though, is basically like the idea of <a href="robowiki@DynamicDistancing" class=wikipagelink>DynamicDistancing</a> in concept, and is also based on the idea of how much energy advantage you would lose or gain if you fired a certain power 100 times in this same situation. -- <a href="robowiki@Kawigi" class=wikipagelink>Kawigi</a>
<p>
The thing I don't get is, how do you figure out what firepower to shoot AFTER selecting the graph segment you're deciding on? Choosing a different firepower based on the graph you find varies the bullet travel time, which varies the segment, so your graph is useless. The only way seems to be pulling off a graph in each segment of bullet travel time, calculating the chances and gains based on firepower for each and every graph, and then comparing them from there. Just seems like a LOT of work, and that usually ends up badly for my robots anyway; besides, in this case you'd be better off segmenting on power and distance rather than flight time. I created a simple firepower selection algorithm in Fractal, and it seems to improve its performance, but I'm sure as soon as I upload it it'l turn to crap. I'm tempted to write a quick firepower optimizer that bases itself on a Flat curve with Flat juice on top; that or I'll change my bullet flight time back to straight distance and just segment on firepower instead, and just compare all the segments of firepower instead of flight time. I'll see what happens. -- <a href="robowiki@Vuen" class=wikipagelink>Vuen</a>
<p>
Interesting to hear such words from MrRocketScientist<a href="robowiki@action=edit&id=MrRocketScientist" class=wikipageedit>?</a> himself! =) I fully agree that complexety usually means bugs. -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
Yeah, <a href="robowiki@Vuen" class=wikipagelink>Vuen</a>, that's what has prevented me from doing choosing firepower based on the segment when I'm segmenting on bullet travel time.  Of course, a study needs to be done on the value of using that vs. using distance I think... -- <a href="robowiki@Kawigi" class=wikipagelink>Kawigi</a>
<p>
There are two cases: trying to maximize energy gain or trying to get as much score for damage as possible. Let's say you have a function to calculate hit posibility with certain firepower. p - probability to hit (0&lt;=p&lt;=1). Probability to miss is 1-p.
1) If you hit: enemy loses Damage, you gain power_returned-firepower. If you do not hit: you gain -firepower. To sum up: F = p*(Damage+power_returned-firepower) - (1-p)*firepower.
2) If you hit: you get score Damage, and you lose firepower energy, so maximum opponent damage is reduced by firepower, you get +firepower score difference. If you miss: you lose firepower energy, +firepower score diference. F = p*(Damage+firepower) + (1-p)*firepower.
You may chose one of these strategies depending on robots' energy. If there is a huge energy difference, it is unworthy to try to win, and so on.
It is possible to combine both methods. pWin(myEnergy, opponentEnergy) returns the probability of winning the round using robots' energy. You may use some kind of statistics or anything you can think of. If you hit: you get 120*pWin(my_e+power_returned-firepower, opp_e-Damage) on average (50 for survivor, 10 for the last survivor. You get 60 or opponent gets 60, that makes the difference 120), and you get Damage+firepower score difference for damage (see case 2). If you miss: 120*pWin(my_e-firepower, opp_e) + firepower. F = p*(120*pWin(my_e+power_returned-firepower, opp_e-Damage)+Damage+firepower) + (1-p)*(120*pWin(my_e-firepower, opp_e)+firepower).
Maybe you can simplify a little: F = 120*pWin(my_e, opp_e) + &lt;score difference for damage&gt;, but I don't know how much accuracy you may lose (probably not much).
You need to maximize F. Possible solution could be calculate all firepower values with certain step (for example, calculate F with firepower 0.1, 0.2, 0.3, ... , 2.9, 3.0). <a href="robowiki@Asm" class=wikipagelink>asm</a>
<p>
After <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>'s successful experiment with an always-fire-2.4 strategy, I've been playing around with various bullet power strategies and looking at what ought to be optimal, from a theoretical point of view.  There are some surprising results....
<p>
To maximize bullet damage; the formula for bullet damage per unit time should be (1/Math<a href="robowiki@action=edit&id=SelectingFirePower/Math" class=wikipageedit>?</a>.ceil(10 + power/.5))*p*(6*power - 2) for 3 &gt;= power &gt; 1, where p is the probability of hitting the opponent.  Of course p is not independent of bullet power.  However, if we assume that the opponent's movement profile is no better at any one range or bullet power than any other, then p is proportional to atan(18/enemyDistance)/Math<a href="robowiki@action=edit&id=SelectingFirePower/Math" class=wikipageedit>?</a>.asin(8/(20 - 3*power)) - that is, the angular bot width over the escape area.  This assumption will probably be false for a given opponent, but true when averaged over the general population - people tune for a variety of bullet powers.
<p>
I ran this equation through a program to find it's value for a given range.  The maximum lies at one bullet power for all ranges; that bullet power is... 2.5.  A bullet power of 2.5 gives you both a smaller escape angle and faster gun cooling than 3.0, and they balance the slightly higher damage.  There are local maxima at both 3 and 2.  Interestingly the theoretical difference between the maximum bullet damage and the damage at 2 is always &lt; 7%.
<p>
Always-fire-2 seems like a crazy strategy, so I ran some tests against <a href="robowiki@VertiLeach" class=wikipagelink>VertiLeach</a>; one with <a href="robowiki@Raiko" class=wikipagelink>Raiko</a> always firing power 3, one power 2.49 and one power 1.99.  Each was over 250 rounds.  In each case Raiko's bullet damage was the same to within &lt; 4%, wich is probably margin-of-error; it was actually highest at 1.99.  This is at very close range, almost always less than 300.
<p>
Interestingly the score was also almost exactly the same, even though survival went up at lower bullet powers.  Why?  Because Verti's bullet damage also went up... obviously, if I run out of energy faster, then the opponent has less chance to score bullet damage points, which balances the extra survival score.
<p>
Conclusion: you can fire pretty much whatever bullet power you like, but 2 isn't a bad number at any range other than point-blank. -- <a href="robowiki@Jamougha" class=wikipagelink>Jamougha</a>
<p>
If you are referring to <a href="robowiki@Aristocles" class=wikipagelink>Aristocles</a> 0.3.0 as my "experiment" I must just make clear that it is not the first time I try with "only power 2.X" where X is on the low half towards 3. <a href="robowiki@Griffon" class=wikipagelink>Griffon</a> does this too. I think it is firing only power 2.2. I have never really figured out why it works so well. As you can see above my only theoretical approach to this problem has lead me to propose maybe the optimum fire power is 1.7 or there about. But you don't see any of my bot fire that low powered bullets. Thanks for sharing your theory and your empirical findings. This gives me some rest in trying to figure this out. "It doesn't really matter much" is the lesson I should have learnt from all my experimentation. But I have been too stubborn and too thick headed to grasp it. Now to a question. The way <a href="robowiki@Tityus" class=wikipagelink>Tityus</a> gun works is to use a fixed bullet power at each distance index in its segmentation. This to avoid segmenting on bullet power. You know this I see since you have kept this property of the gun. But, if it doesn't matter much what bullet power you use at given distances. Is it worth while to lower your bullet power with distance like <a href="robowiki@Tityus" class=wikipagelink>Tityus</a> and its descendants do? -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
Good question... inside a bullet travel time of about 5 it should be possible to write a linear prediction gun with near 100% hit rate, since the opponent just cant change direction or velocity quickly enough.  Here it's better to fire power 3, if you have written such a gun... but I haven't, yet. :-)  Still, with long learning times firing 3 inside distance 100 is probably a good idea.  At very long ranges it might also be worthwhile to fire lower power, so as to increase survival.  However between 100 and ~600 I'm pretty certain than constant firepower is just fine, and since 2.5 and 2 are generally 'good' values for bullet damage I'm inclined to pick one and stick to it.  Especially in a microbot, where it's saving me enough codesize to introduce wall segmentation and finally thrash Sedan. ;-) - <a href="robowiki@Jamougha" class=wikipagelink>Jamougha</a>
<p>
<hr noshade class=wikiline size=1>
OK. Can't someone just say the words: "it seems like there's some merit to your theory about maximizing the <code>damage / escape_angle</code> ratio PEZ"? =) -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
It seems like there's some merit to your theory about maximizing the <code>damage / escape_angle</code> ratio, PEZ. I know I've started using 1.9 in Cyanide. -- <a href="robowiki@Alcatraz" class=wikipagelink>Alcatraz</a>
<p>
Thanks! It took many months for someone to give me those words. And some begging. =) -- <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>
<p>
Well, i already said "Thanks, <a href="robowiki@PEZ" class=wikipagelink>PEZ</a>!!", but since i really think that it was brilliant there it goes: it seems like there's some merit to your theory about maximizing the <code>damage / escape_angle</code> ratio PEZ! -- <a href="robowiki@Axe" class=wikipagelink>Axe</a>
<p>
I think the graph is misleading, but I did do quite a bit of tinkering in Excel to find what I think should be a magic number.  I did factor in damage, escape angle, and some other stuff.  I have plans to factor in some dynamic information as well, but a fixed number will do for now.  Previously I was iterating through several firepowers and comparing the damage potential to my historical hit percentages at that range.  I'm going to redesign my virtual guns statistics so it is time to revamp my firepower selection, which should speed up my bot quite a bit as well.  -- <a href="robowiki@Martin_Alan_Pedersen" class=wikipagelink>Martin</a> / <a href="robowiki@Ugluk" class=wikipagelink>Ugluk</a>
<p>
How do you find out the specific probability for a firepower (to use the formula on top)? --<a href="robowiki@Starrynte" class=wikipagelink>Starrynte</a>
<p>
Is it <tt>p = atan(18/enemyDistance)/Math<a href="robowiki@action=edit&id=SelectingFirePower/Math" class=wikipageedit>?</a>.asin(8/(20 - 3*power));</tt>?
<p>
Do you mean the probability that it will hit the enemy at a certain distance with a certain fire power? If so, I think that would be (approximately) <code>(18 / distance) / Math.asin(8 / bulletVelocity(firepower))</code>, which is the angle that half a bot takes up at a certain distance divided by the angle they could move in one direction (at any distance). Bullet velocity is (20 - 3 * power). -- <a href="robowiki@Voidious" class=wikipagelink>Voidious</a>
<p>
<hr noshade class=wikiline size=1>
<p>
I wonder... currently I'm pondering a way to really make a good firepower selection... Right now I'm thinking of tracking a special "hitrate relative to nominal"  based where have counter 'a', and 'b'. Every time I hit, 'a' and 'b' are both incremented by (1 / (angular botwidth / max escape angle)), and when I miss only 'b' is incremented. The theoretical hitrate at a given distance and bulletpower is subsequently calculated from ((a/b)*(angular botwidth / max escape angle)). In order to select optimal bulletpower, I'll combine that later equation with the gain function at the top of the page, and do a little calculus/algebra to solve for the maximum gain. I think that would create a bullet power selection that should be optimal at any hitrate/distance and consider how distance affects hitrate. The only catch is it does not consider things like how a fleeing bot may be easier to hit, to take that into consideration would require integrating learning stats as well which I I'm not sure if I'd trust to be robust enough. Any thoughts on this idea for selecting bulletpower with consideration for both hitrate and distance? -- <a href="robowiki@Rednaxela" class=wikipagelink>Rednaxela</a>
<p>
Sounds like you have it pretty well figured out. One other thing you may want to consider is the height of the spike that you are shooting at in your gun stats. As to whether it is robust enough, there's only one way to find out =) Hack up a messy implementation, and see where it gets you =) If it helps, integrate it a bit better. Good luck, wish I had time at the moment to do something like this. -- <a href="robowiki@Skilgannon" class=wikipagelink>Skilgannon</a>
<p>
Haha, well, I was thinking of something like that with the height of the spike in gun stats, but the problem is that after some of my crowdtargeting experiments, I'm not sure I 100% trust gun stat data besides the location of the peak. I'll probably first start with a basic version without consideration for gun stats. Actually, another problem with using gun stats, is when some of your segments are influencthed by the bulletpower you select (I use wall segments measured in GF units, and some other people segment on bulletpower or bullet-travel-time I think), you'd run into a chicken and the egg problem. And time? I won't have time for something like this until winter break. For the moment I'm just hyping :) One other note, is besides that 'optimal formula' I plan to also make special conditions for some "game theory" considerations mentioned earlier on this page by <a href="robowiki@Frakir" class=wikipagelink>Frakir</a>, which come into play in the 'endgame' (i.e. if the opponant can be finished off, our own energy gain isn't really important and a chance for a finishing blow might be worth sacrificing a little hitrate for?). Maybe I'm dreaming, but I think that better firepower selection might really boost <a href="robowiki@RougeDC" class=wikipagelink>RougeDC</a>'s rank... after all it's default bulletpower of 2.5 I believe seems sub-optimal against bots it can't hit well. I first intended for <a href="robowiki@RougeDC" class=wikipagelink>RougeDC</a> Classic to be the final release of <a href="robowiki@RougeDC" class=wikipagelink>RougeDC</a>, but I think it's the best way to test my theories for selecting firing power... I suppose this, and maybe a related dynamic distancing plan, will be a last-ditch effort to raise <a href="robowiki@RougeDC" class=wikipagelink>RougeDC</a> into the top-10 before I focus on my other plans like how to smear the wall with current-generation learning bots. &lt;/rant&gt; -- <a href="robowiki@Rednaxela" class=wikipagelink>Rednaxela</a>
<p>
How about trying a base bullet power of 2? It's what I use with <a href="robowiki@DrussGT" class=wikipagelink>DrussGT</a>, <a href="robowiki@Voidious" class=wikipagelink>Voidious</a> uses with <a href="robowiki@Dookious" class=wikipagelink>Dookious</a>, David uses with <a href="robowiki@Phoenix" class=wikipagelink>Phoenix</a> etc etc. -- <a href="robowiki@Skilgannon" class=wikipagelink>Skilgannon</a>
<p>
Yeah, I hear that base powers of either 2 or 1.9 are quite common among strong bots, but I think, if I'm going to fix <a href="robowiki@RougeDC" class=wikipagelink>RougeDC</a>'s bullet power, why not go all the way with an adaptive 'optimal' solution? After all it's not as if keeping the necessary counters would be difficult :) -- <a href="robowiki@Rednaxela" class=wikipagelink>Rednaxela</a>
<br> Oh... Haha... I did mess up my description of how to do it above. Counter 'b' should just be incremented by 1, not the fancy number. :) -- <a href="robowiki@Rednaxela" class=wikipagelink>Rednaxela</a>
w
Haha, only now did I read into Albert's text block further, and realized that what Albert was using in Mamba was far closer to what I propose than I thought, with the only difference being that instead of the "a(p)" function he uses, I use an a(p, d), where d is distance and the function is based on 'maxescapeangle' and considers the bot's angular width. Funny how I failed to notice the section of the page where Albert talked about maximizing gain and got lost in my own thoughts about it. Still, it's likely <a href="robowiki@RougeDC" class=wikipagelink>RougeDC</a> may soon have the most advanced bullet power selection out there :) -- <a href="robowiki@Rednaxela" class=wikipagelink>Rednaxela</a>
<p>
So for a quick test here, I made <a href="robowiki@RougeDC" class=wikipagelink>RougeDC</a> use a bullet power of 1.9 normally instead of the 2.5, and in a quick battle I scored 49% against Shadow instead of about 39% which is a big difference! It's looking like at very least, <a href="robowiki@RougeDC" class=wikipagelink>RougeDC</a> could become a top-notch PL contender with even minor tweaks to bulletpower... I wonder if I should release the 1.9 bulletpower version before I get the fancy dynamic bulletpower finished. -- <a href="robowiki@Rednaxela" class=wikipagelink>Rednaxela</a>
<br><strong>Update:</strong> Well after additional trials, I found that the 49% was partly luck, but still 1.9 was an improvement over 2.5. I just got the adaptive firepower working based on the normalized-hitrate/botwidth/escapeangle/energygain/etc. and against Shadow it was choosing anything from about 0.35 to 1.6 for most of the match, depending on the exact moment. The end result on score? Worse overall scoring, similar to the old 2.5, <strong>however</strong> execelent near 1:1 survival ratio. Against Cunobelin 0.2.2, once it's stabalized it seems to select bullet power more in the 1.35 to 1.9 range, scoring a little better overall, but cutting Cunobelin's survival to about 2/3rds of what it used to be. After I get this survival mechanism perfected... I'll make a modified mechanism in the same spirit only designed for score... :) -- <a href="robowiki@Rednaxela" class=wikipagelink>Rednaxela</a>
<p>
Well I haven't yet made a method that optimizes for score logical semi-formal way, but what I have found is that optimizing 2/3rds for energy gain and 1/3rd for bullet damage seems to yield a decent result again Shadow.
<TABLE CELLSPACING='0' CELLPADDING='1' BORDER='1'>
<TR VALIGN='CENTER' ><td colspan='0.5'> Rank </td><td colspan="0.5"> Robot Name </td><td colspan="0.5"> Total Score </td><td colspan="0.5"> Survival </td><td colspan="0.5"> Surv Bonus </td><td colspan="0.5"> Bullet Dmg </td><td colspan="0.5"> Bullet Bonus </td><td colspan="0.5"> Ram Dmg * 2 </td><td colspan="0.5"> Ram Bonus </td><td colspan="0.5"> 1sts </td><td colspan="0.5"> 2nds </td><td colspan="0.5"> 3rds </td></TR>
<TR VALIGN='CENTER' ><td colspan='0.5'> 1st </td><td colspan="0.5"> abc.<a href="robowiki@Shadow" class=wikipagelink>Shadow</a> 3.83c </td><td colspan="0.5"> 2719 (50%) </td><td colspan="0.5"> 750 </td><td colspan="0.5"> 150 </td><td colspan="0.5"> 1642 </td><td colspan="0.5"> 177 </td><td colspan="0.5"> 0 </td><td colspan="0.5"> 0 </td><td colspan="0.5"> 15 </td><td colspan="0.5"> 20 </td><td colspan="0.5"> 0</td></TR>
<TR VALIGN='CENTER' ><td colspan='0.5'> 2nd </td><td colspan="0.5"> ags.rougedc.<a href="robowiki@RougeDC" class=wikipagelink>RougeDC</a> (dev) </td><td colspan="0.5"> 2703 (50%) </td><td colspan="0.5"> 1000 </td><td colspan="0.5"> 200 </td><td colspan="0.5"> 1329 </td><td colspan="0.5"> 174 </td><td colspan="0.5"> 0 </td><td colspan="0.5"> 0 </td><td colspan="0.5"> 20 </td><td colspan="0.5"> 15 </td><td colspan="0.5"> 0</td></TR>
</TABLE>
This would be the best result I've seen again Shadow so far. Anyone think it would bew fair to simultaneously release the following rumble editions "bp1.9", "survivalist", and "balanced" at once or would that clog the rumble too much? -- <a href="robowiki@Rednaxela" class=wikipagelink>Rednaxela</a>
<p>
Cool! Good work. It should be fine having 3 versions at once, as long as they're temporary. It'll be interesting how your weighting system ends up, the kind of bullet powers it finds optimal, etc. -- <a href="robowiki@Skilgannon" class=wikipagelink>Skilgannon</a>
<p>
Alright the 3 new versions are up there now. Well, one thing I noticed is the "balanced" one that I just mentioned seems to like bulletpowers in the 1.8 to 2.3 range against most medium to subtop movements, in the 2.3 to 3.0 range against the very most easy to hit things (rambots, spinbots), and more like 1.35 to 1.9 against the top movements that my gun really can't hit well. Overall it seems to confirm that the 1.9/2.0 values are quite sane usually. Feel free to try yourself if you want to, it does output it's bulletpower selections in the robot console, among other debugging spamminess I should really remove. Anyways, will be interesting to see how the rankings of these versions will compare. -- <a href="robowiki@Rednaxela" class=wikipagelink>Rednaxela</a>
<p>
Interesting how bp1.9 dominates the other 3 in the PL, while balance gets the highest score. -- <a href="robowiki@Skilgannon" class=wikipagelink>Skilgannon</a>
<p>
Oh, and just looking at your explanation, why are you incrementing 'b' when you get a hit? Surely you should increment 'b' whenever a wave passes, and increment 'a' when you get a hit? -- <a href="robowiki@Skilgannon" class=wikipagelink>Skilgannon</a>
<p>
It is interesting how bp1.9 is so good in PL, that I didn't expect. The survival percents are as I expected though, with Classic being worst, then bp1.9, then balanced, then survival as the best at survival. The overall ranking order of the 4 is also what I expected, though the size of the gaps between them is not. Actually, here's a really good example of how '<a href="robowiki@RougeDC" class=wikipagelink>RougeDC</a> survival' can kill an enemy's survival rate: <a rel="nofollow" href="http://darkcanuck.net/rumble/BattleDetails@game=roborumble&amp;name=jk.micro.Toorkild%200.1.1&amp;vs=ags.rougedc.RougeDC%20balance">[balance]</a> vs. <a rel="nofollow" href="http://darkcanuck.net/rumble/BattleDetails@game=roborumble&amp;name=jk.micro.Toorkild%200.1.1&amp;vs=ags.rougedc.RougeDC%20survival">[survival]</a>.... poor Toorkild... :)
<p>
Nope, each value I add to 'a' is a reperesentation of how likely it was I hit (well if I am adding to 'a', 1 is how likely I did hit) compared to chance of random targeting hitting. When I miss I "add 0" to 'a', in other words doing nothing. Then 'b' is a counter of how many times I've gotten hit/miss data in total. This makes 'a'/'b' become the average value of my "normalized hitrate", which is either (1/randomhitrate) or 0 at any given data point, but is somewhere in the middle on average. Make any more sense? -- <a href="robowiki@Rednaxela" class=wikipagelink>Rednaxela</a>
<p>
Hey, leave Toorkild alone and pick on bots your own size! :-p Yip, I understand what you're doing with the a,b thing now, you get the radian-chance-product of hitting as a/b. Smart thinking. The way I do it in <a href="robowiki@DrussGT" class=wikipagelink>DrussGT</a> (in the movement, to keep track of hitrate for the flattener) is to increment both 'a' and 'b' by the botwidth/MEA. So there 1.0 is the maximum, and I know to enable my flattener above 0.095. Here you're looking for something different, the highest chance of hitting. Very cool idea, and easy to implement. Perhaps you could even couple this with enemy hitrates to calculate the best distance to fight at? =) -- <a href="robowiki@Skilgannon" class=wikipagelink>Skilgannon</a>
<p>
Haha, actually, I've been thinking of doing distancing like that for a bit. The only thing is, I'm not sure if I should FIRST get a better more 'scientific' score-optimized system, as that would benifit both that and the bulletpower stuff. It would take a bit to formulate though. -- <a href="robowiki@Rednaxela" class=wikipagelink>Rednaxela</a>
</div><hr class=wikilinefooter>
<div class=wikifooter><form method="post" action="robowiki" enctype="application/x-www-form-urlencoded">
<a href="robowiki@Robo_Home" class=wikipagelink>Robo Home</a> | <a href="robowiki@Changes" class=wikipagelink>Changes</a> | <a href="robowiki@action=editprefs">Preferences</a> | <a href='?action=index'>AllPages</a><br>
<a href="robowiki@action=edit&id=SelectingFirePower" class=wikipageedit>Edit text of this page</a> | <a href="robowiki@action=history&id=SelectingFirePower">View other revisions</a><br>Last edited November 27, 2008 6:12 EST by <a href="robowiki@Rednaxela" title="ID 16805 from h128-108.reznet.ucalgary.ca">Rednaxela</a> <a href="robowiki@action=browse&diff=1&id=SelectingFirePower">(diff)</a><br>Search: <input type="text" name="search"  size="20" /><input type="hidden" name="dosearch" value="1"  /></form></div>
</body>
</html>